name: CI Pipeline

on:
  pull_request:
    branches: [ main, master ]

jobs:
  unittest:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-python@v4
      with:
        python-version: "3.11"
    - run: pip install -r requirements.txt pytest
    - run: pytest homework/

  mypy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-python@v4
      with:
        python-version: "3.11"
    - run: pip install mypy
    - run: pip install sqlalchemy2-stubs types-pydantic types-pytest pytest-asyncio httpx-socks
    - run: pip install fastapi sqlalchemy pydantic httpx pytest pytest-asyncio aiosqlite
    - run: mypy homework/

  black:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-python@v4
      with:
        python-version: "3.11"
    - run: pip install black
    - run: black homework/

  isort:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-python@v4
      with:
        python-version: "3.11"
    - run: pip install isort
    - run: isort homework/

  flake8:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-python@v4
      with:
        python-version: "3.11"
    - run: pip install flake8
    - run: flake8 homework/
